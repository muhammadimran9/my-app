'use client'; import { useState, useEffect } from 'react'; import { usePathname } from 'next/navigation'; import ThemedButton from './ThemedButton'; export default function PWABanner() { const [deferredPrompt, setDeferredPrompt] = useState(null); const [showBanner, setShowBanner] = useState(false); const pathname = usePathname(); useEffect(() => { const handler = (e) => { e.preventDefault(); setDeferredPrompt(e); setShowBanner(true); }; window.addEventListener('beforeinstallprompt', handler); if (window.matchMedia('(display-mode: standalone)').matches) { setShowBanner(false); } return () => window.removeEventListener('beforeinstallprompt', handler); }, []); const handleInstall = async () => { if (!deferredPrompt) return; deferredPrompt.prompt(); const { outcome } = await deferredPrompt.userChoice; if (outcome === 'accepted') { setShowBanner(false); } setDeferredPrompt(null); }; const handleDismiss = () => { setShowBanner(false); localStorage.setItem('pwa-banner-dismissed', 'true'); }; if (!showBanner || localStorage.getItem('pwa-banner-dismissed')) return null; return ( <div className=\"fixed top-0 left-0 right-0 z-50 p-3 theme-card border-b\" style={{ background: 'var(--card-bg)', borderColor: 'var(--border-color)', boxShadow: '0 2px 8px var(--shadow)' }} > <div className=\"container-responsive flex items-center justify-between gap-3\"> <div className=\"flex items-center gap-3\"> <img src=\"/images/profile-pic.jpeg\" alt=\"Spot For You\" className=\"w-8 h-8 rounded-full\" /> <div> <p className=\"font-medium text-sm\" style={{ color: 'var(--foreground)' }}> Install Spot For You </p> <p className=\"text-xs\" style={{ color: 'var(--text-muted)' }}> Get the app experience on {pathname} </p> </div> </div> <div className=\"flex items-center gap-2\"> <ThemedButton onClick={handleInstall} size=\"sm\">\n            Install\n          </ThemedButton>\n          <button \n            onClick={handleDismiss}\n            className=\"p-1 rounded\" \n            style={{ color: 'var(--text-muted)' }}\n          >\n            <svg width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"/>\n            </svg>\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}
