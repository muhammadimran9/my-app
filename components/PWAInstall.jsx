'use client'; import { useState, useEffect } from 'react'; import ThemedButton from './ThemedButton'; export default function PWAInstall() { const [deferredPrompt, setDeferredPrompt] = useState(null); const [showInstall, setShowInstall] = useState(false); useEffect(() => { const handler = (e) => { e.preventDefault(); setDeferredPrompt(e); setShowInstall(true); }; window.addEventListener('beforeinstallprompt', handler); if (window.matchMedia('(display-mode: standalone)').matches) { setShowInstall(false); } return () => window.removeEventListener('beforeinstallprompt', handler); }, []); const handleInstall = async () => { if (!deferredPrompt) return; deferredPrompt.prompt(); const { outcome } = await deferredPrompt.userChoice; if (outcome === 'accepted') { setShowInstall(false); } setDeferredPrompt(null); }; if (!showInstall) return null; return ( <ThemedButton onClick={handleInstall} variant="outline" size="sm" className="flex items-center gap-2" > <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24"> <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/> </svg> Install App </ThemedButton> ); }
