"use client"; import React, { useEffect, useState } from 'react'; const GitHubContributions = ({ username }) => { const [contributions, setContributions] = useState(null); const [loading, setLoading] = useState(true); const [error, setError] = useState(null); useEffect(() => { fetchContributions(); }, [username]); const fetchContributions = async () => { try { setLoading(true); const url = username ? `/api/github/contributions?username=${username}` : '/api/github/contributions'; const response = await fetch(url); const data = await response.json(); if (data.error) { throw new Error(data.error); } setContributions(data.user?.contributionsCollection?.contributionCalendar); } catch (err) { setError(err.message); console.error('Error fetching contributions:', err); } finally { setLoading(false); } }; if (loading) { return ( <div className="rounded-2xl border-[1.5px] border-neutral-300 bg-neutral-100 dark:border-neutral-800 dark:bg-neutral-900 p-6"> <div className="animate-pulse space-y-4"> <div className="h-6 bg-neutral-300 dark:bg-neutral-700 rounded w-1/3"></div> <div className="grid grid-cols-53 gap-1"> {Array.from({ length: 371 }).map((_, i) => ( <div key={i} className="h-3 bg-neutral-300 dark:bg-neutral-700 rounded"></div> ))} </div> </div> </div> ); } if (error || !contributions) { return ( <div className="rounded-2xl border-[1.5px] border-neutral-300 bg-neutral-100 dark:border-neutral-800 dark:bg-neutral-900 p-6"> <p className="text-neutral-600 dark:text-neutral-400"> Unable to load GitHub contributions. Please check your API configuration. </p> </div> ); } const weeks = contributions.weeks || []; const totalContributions = contributions.totalContributions || 0; const getContributionLevel = (count) => { if (count === 0) return 0; if (count <= 3) return 1; if (count <= 6) return 2; if (count <= 10) return 3; return 4; }; const getColor = (level) => { const colors = { 0: 'bg-neutral-200 dark:bg-neutral-800', 1: 'bg-green-200 dark:bg-green-900/30', 2: 'bg-green-400 dark:bg-green-700', 3: 'bg-green-600 dark:bg-green-600', 4: 'bg-green-800 dark:bg-green-500', }; return colors[level] || colors[0]; }; const monthLabels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']; const dayLabels = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']; const monthPositions = []; let currentMonth = -1; weeks.forEach((week, weekIndex) => { week.contributionDays.forEach((day) => { const date = new Date(day.date); const month = date.getMonth(); if (month !== currentMonth) { monthPositions.push({ month, weekIndex }); currentMonth = month; } }); }); return ( <div className="rounded-2xl border-[1.5px] border-neutral-300 bg-neutral-100 dark:border-neutral-800 dark:bg-neutral-900 p-6"> <div className="mb-4"> <h2 className="text-xl font-medium text-neutral-800 dark:text-neutral-300 mb-2"> GitHub Contributions </h2> <p className="text-sm text-neutral-600 dark:text-neutral-400"> {totalContributions.toLocaleString()} contributions in the last year </p> </div> <div className="overflow-x-auto"> <div className="inline-block min-w-full"> <div className="flex gap-1 relative"> {/* Day labels */} <div className="flex flex-col gap-1 mr-2 pt-3"> {dayLabels.map((day, idx) => ( <div key={idx} className="text-xs text-neutral-600 dark:text-neutral-400 h-3" style={{ visibility: idx % 2 === 0 ? 'visible' : 'hidden' }} > {day} </div> ))} </div> {/* Contribution grid with month labels */} <div className="flex-1 relative"> {/* Month labels */} <div className="absolute -top-5 left-0 right-0 flex"> {monthPositions.map(({ month, weekIndex }, idx) => ( <div key={idx} className="text-xs text-neutral-600 dark:text-neutral-400" style={{ position: 'absolute', left: `${weekIndex * 14}px`, }} > {monthLabels[month]} </div> ))} </div> {/* Contribution grid */} <div className="flex gap-1 pt-1"> {weeks.map((week, weekIndex) => ( <div key={weekIndex} className="flex flex-col gap-1"> {week.contributionDays.map((day, dayIndex) => { const level = getContributionLevel(day.contributionCount); const date = new Date(day.date); return ( <div key={dayIndex} className={`w-3 h-3 rounded ${getColor(level)} transition-colors hover:ring-2 hover:ring-neutral-400 dark:hover:ring-neutral-600 cursor-pointer`} title={`${day.contributionCount} contributions on ${date.toLocaleDateString()}`} /> ); })} </div> ))} </div> </div> </div> {/* Legend */} <div className="flex items-center gap-2 mt-4 text-xs text-neutral-600 dark:text-neutral-400"> <span>Less</span> <div className="flex gap-1"> {[0, 1, 2, 3, 4].map((level) => ( <div key={level} className={`w-3 h-3 rounded ${getColor(level)}`} /> ))} </div> <span>More</span> </div> </div> </div> </div> ); }; export default GitHubContributions;
