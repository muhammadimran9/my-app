'use client'; import { createContext, useContext, useEffect, useState } from 'react'; const ThemeContext = createContext(); export function ThemeProvider({ children }) { const [theme, setTheme] = useState('light'); const [mounted, setMounted] = useState(false); useEffect(() => { setMounted(true); const savedTheme = localStorage.getItem('theme'); if (savedTheme) { setTheme(savedTheme); applyTheme(savedTheme); } else { const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches; const systemTheme = prefersDark ? 'dark' : 'light'; setTheme(systemTheme); applyTheme(systemTheme); } }, []); const applyTheme = (newTheme) => { const root = document.documentElement; if (newTheme === 'dark') { root.classList.add('dark'); root.style.colorScheme = 'dark'; } else { root.classList.remove('dark'); root.style.colorScheme = 'light'; } }; const toggleTheme = () => { const newTheme = theme === 'light' ? 'dark' : 'light'; setTheme(newTheme); localStorage.setItem('theme', newTheme); applyTheme(newTheme); }; const value = { theme, toggleTheme, isDark: theme === 'dark' }; if (!mounted) { return null; } return ( <ThemeContext.Provider value={value}> {children} </ThemeContext.Provider> ); } export function useTheme() { const context = useContext(ThemeContext); if (context === undefined) { throw new Error('useTheme must be used within a ThemeProvider'); } return context; }
